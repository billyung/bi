<div id=mainHeading><div class=boldLabel> COLLECTIONS:</div> All Branches Remaining</div>
<div id=remainingObj></div>

<script language="javascript" type="text/javascript">

function setUpRemaining(getRemainingQueryParam, completedParam, nameHeadingParam, drillClickParam)
{

  var remainingText = " Remaining";

  var getRemainingQuery = getRemainingQueryParam;
  var completed = completedParam;
  var completedPC = "% " + completed;
  var nameHeading = nameHeadingParam + remainingText;
  var drillClick = drillClickParam;

  var MetaLayerVar = {

    remainingDef: {
      colHeaders: ["Id", nameHeading, "Expected", completed, completedPC],
      colTypes: ['numeric','string','numeric','numeric','numeric'],
	colFormats: [null, null, "%15.1f", "%15.1f", "%3.1f"],
      tableStyle: "classic",
	paginate: false,
	sort: true,
	sortBy: [[4,'desc']],
	filter: false,
	info: false,
      dataAccessId: getRemainingQuery, 
	path: cdaPath
    }

  };


var remaining =
	{
 		name: "remaining",
		type: "tableComponent",
    		chartDefinition: MetaLayerVar.remainingDef,
		parameters: [["currentDate","currentDate"]],
		cdaParams: [["currentDate","currentDate"]],
    		htmlObject: "remainingObj",
    		executeAtStart: true,
  		postExecution: function(){
					$("#remainingObj td:nth-child(2)").each(function(index) {
						var branchParams = "&branchId=" + $(this).parent().children("td:nth-child(1)").text();
						branchParams = branchParams  + "&branchName=" + $(this).parent().children("td:nth-child(2)").text();
						var linkBranchName = '<a href="#" onclick="linkToPage(' + "'" + drillClick + "', '" + branchParams + "'" + ');return false;">' + $(this).text() + '</a>';
						$(this).html(linkBranchName);
  					});

   					$("#remainingObj th").addClass("tableHeading");
   					$("#remainingObj th").css("background-color", darkBlue);
   					$("#remainingObj th").css("color", white);
   					$("#remainingObj th:nth-child(1)").hide();
   					$("#remainingObj td:nth-child(1)").hide();
   					$("#remainingObj_wrapper").removeClass("dataTables_wrapper");

					$("#remainingObj").css("color", black);
					$("#remainingObj tbody tr").each(function(index) {
						if ($(this).hasClass("odd"))
						{
							$(this).css("background-color", oddRow);
						}
						else
						{
							$(this).css("background-color", evenRow);
						}				
  					});
  				}
  };

  Dashboards.init([remaining]);

}

setUpRemaining("getRemainingBranchesCollection", "Collected", "Branches", "CollectionsLO");

$(document).ready(function() {
	finalisePage();
});

</script>

