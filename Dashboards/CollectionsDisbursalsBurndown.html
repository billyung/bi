
<style type="text/css">

.headone {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 14px;
	padding-top: 30px;

}

#burndown {
	padding-left: 10px;
	padding-top: 10px;
	padding-right: 10px;
}

#displayArea {
	padding-top: 20px;
}

#toptableObj table {
	font-size: 110%;
}

.highlightRowxx { 
	background-colour: #09B4ED;
}

.highlightRow { 
	font-style:italic;
	font-weight:bold;
	font-size:130%;
	color: black;
}

.hl { 
	border-color: black;
	border-width: 1px;
	border-bottom: solid;
}


</style>

<div id="burndown">
	<div id=toptableObj></div>

<table>
<tr>
<td VALIGN="TOP">
	<div id=collectionObj></div>
</td>
<td VALIGN="TOP">
	<div id=disbursementObj></div>

</td>
</tr>
</table>

<div id="displayArea">
<table>
	<tr>
		<td width="50%"><div id="displayOneObj"></div></td>
		<td width="50%"><div id="displayTwoObj"></div></td>
	</tr>
</table>
</div>
</div>


<script language="javascript" type="text/javascript">

function pad2(number) {
    return (number < 10 ? '0' : '') + number
}

function getTime()
{
	currentTime = new Date();
	return pad2(currentTime.getHours()) + ":" + pad2(currentTime.getMinutes()) + ":" + pad2(currentTime.getSeconds());
}

var currtime = getTime();
var collectionClickedEvent = 0;
var disbursementClickedEvent = 0;
var selectedBranchId = 0;
var selectedBranchIdDisb = 0;
var solution = Dashboards.getQueryParameter("solution");
var path = Dashboards.getQueryParameter("path");
var cdaPath = solution + "/" + "CollectionsDisbursalsBurndown.cda";


Dashboards.globalcontext = false;



//section for collect and disbursement pie charts

function clearDisplay()
{
	$('#displayOneObj').html("");
	$('#displayTwoObj').html("");
}

function collectionClicked()
{
	clearDisplay();
	collectionClickedEvent = collectionClickedEvent + 1;
	Dashboards.fireChange("collectionClickedEvent", collectionClickedEvent);
}

function disbursementClicked()
{
	clearDisplay();
	disbursementClickedEvent = disbursementClickedEvent + 1;
	Dashboards.fireChange("disbursementClickedEvent", disbursementClickedEvent);
}


collection = {
	name:"collection", 
	type: "XactionComponent",
	solution: solution, 
	path: path,
	action: "collectionProgress.xaction",
	htmlObject: "collectionObj",
	executeAtStart: true
};

disbursement = {
	name:"disbursement", 
	type: "XactionComponent",
	solution: solution, 
	path: path,
	action: "disbursementProgress.xaction",
	htmlObject: "disbursementObj",
	executeAtStart: true
};

//



//section for remaining branch collections

var clickFunction = function(){

	var selectedBranchId = $(this).children('td:nth-child(1)').text(); 

	$(this).parent().children('tr').removeClass("highlightRow");
	$(this).addClass("highlightRow");

	Dashboards.fireChange("selectedBranchId", selectedBranchId);
}

var clickFunctionDisb = function(){

	var selectedBranchIdDisb = $(this).children('td:nth-child(1)').text(); 

	$(this).parent().children('tr').removeClass("highlightRow");
	$(this).addClass("highlightRow");

	Dashboards.fireChange("selectedBranchIdDisb", selectedBranchIdDisb);
}

var clickFunctionLO = function(){
	$(this).parent().children('tr').removeClass("highlightRow");
	$(this).addClass("highlightRow");

	alert("Loan Officer is as far as it goes for the moment");
}

var clickFunctionLODisb = function(){
	$(this).parent().children('tr').removeClass("highlightRow");
	$(this).addClass("highlightRow");

	alert("Loan Officer Disbursements is as far as it goes for the moment");
}

var mouseoverFunction = function(){
 var oldColor = $(this).css("background-color");
 $(this).data("oldColor",oldColor);
 $(this).css("background-color","#09B4ED");
 $(this).css("cursor","pointer");
}

var mouseoutFunction = function(){
	$(this).css("background-color",$(this).data("oldColor"));
	$(this).css("cursor","default");
}

  var MetaLayerVar = {
    toptableDef: {
      colHeaders: [" ", "Branches", "Centers", "Clients", "Collection", "Disbursement"],
      colTypes: ['string','numeric','numeric','numeric','numeric','numeric'],
      tableStyle: "classic",
	paginate: false,
	sort: false,
	filter: false,
	info: false,
      dataAccessId: "getTargetAndCompleted", 
	path: cdaPath
    },

    branchDef: {
      colHeaders: ["Id", "Branches Remaining", "Expected", "Collected", "% Collected"],
      colTypes: ['numeric','string','numeric','numeric','numeric'],
      colWidths: ['30px','200px','100px','100px','100px'],
      tableStyle: "classic",
	paginate: false,
	sort: true,
	filter: false,
	info: true,
      dataAccessId: "getRemainingBranchesCollection", 
	path: cdaPath
    },


    loanOfficerDef: {
      colHeaders: ["Id", "Loan Officers Remaining", "Expected", "Collected", "% Collected"],
      colTypes: ['numeric','string','numeric','numeric','numeric'],
      colWidths: ['30px','200px','100px','100px','100px'],
      tableStyle: "classic",
	paginate: false,
	sort: true,
	filter: false,
	info: true,
      dataAccessId: "getRemainingLoanOfficersCollection", 
	path: cdaPath
    },

    branchDefDisb: {
      colHeaders: ["Id", "Branches Remaining", "Expected", "Collected", "% Collected"],
      colTypes: ['numeric','string','numeric','numeric','numeric'],
      colWidths: ['30px','200px','100px','100px','100px'],
      tableStyle: "classic",
	paginate: false,
	sort: true,
	filter: false,
	info: true,
      dataAccessId: "getRemainingBranchesDisbursement", 
	path: cdaPath
    },

    loanOfficerDefDisb: {
      colHeaders: ["Id", "Loan Officers Remaining", "Expected", "Collected", "% Collected"],
      colTypes: ['numeric','string','numeric','numeric','numeric'],
      colWidths: ['30px','200px','100px','100px','100px'],
      tableStyle: "classic",
	paginate: false,
	sort: true,
	filter: false,
	info: true,
      dataAccessId: "getRemainingLoanOfficersDisbursement", 
	path: cdaPath
    }


  };


var toptable =
	{
 		name: "toptable",
		type: "tableComponent",

    		chartDefinition: MetaLayerVar.toptableDef,
    		htmlObject: "toptableObj",
    		executeAtStart: true,
  		postExecution: function(){
   					$("#toptableObjTable").css("border-collapse","collapse");
   					$("#toptableObjTable th").css("text-align","right");
   					$("#toptableObjTable th").css("border-bottom","solid");
   					$("#toptableObjTable th").css("border-width","1px");
   					$("#toptableObjTable th").css("border-color","black");
   					$("#toptableObjTable td").css("background-color","white");
   					$("#toptableObjTable_wrapper").removeClass("dataTables_wrapper");
  				}

  };


var remainingBranchesCollection =
	{
 		name: "remainingBranchesCollection",
		type: "tableComponent",
		listeners: ["collectionClickedEvent"],

    		chartDefinition: MetaLayerVar.branchDef,
    		htmlObject: "displayOneObj",
    		executeAtStart: false,
  		postExecution: function(){
   					var rows = $("#displayOneObj tbody tr");
   					rows.die("click");
   					rows.die("mouseover");
   					rows.die("mouseout");
   					rows.live("click", clickFunction);
   					rows.live("mouseover",mouseoverFunction);
   					rows.live("mouseout",mouseoutFunction);
   					$("#displayOneObj th:nth-child(1)").hide();
   					$("#displayOneObj td:nth-child(1)").hide();
  				}
  };


var remainingLoanOfficersCollection =
	{
 		name: "remainingLoanOfficersCollection",
		type: "tableComponent",
		listeners: ["selectedBranchId"],
		parameters: [["selectedBranchId","selectedBranchId"]],
		cdaParams: [["selectedBranchId","selectedBranchId"]],
    		chartDefinition: MetaLayerVar.loanOfficerDef,
    		htmlObject: "displayTwoObj",
    		executeAtStart: false,
  		postExecution: function(){
   					var rows = $("#displayTwoObj tbody tr");
   					rows.die("click");
   					rows.die("mouseover");
   					rows.die("mouseout");
   					rows.live("click", clickFunctionLO);
   					rows.live("mouseover",mouseoverFunction);
   					rows.live("mouseout",mouseoutFunction);
   					$("#displayTwoObj th:nth-child(1)").hide();
   					$("#displayTwoObj td:nth-child(1)").hide();
  				}
  };


var remainingBranchesDisbursement =
	{
 		name: "remainingBranchesDisbursement",
		type: "tableComponent",
		listeners: ["disbursementClickedEvent"],

    		chartDefinition: MetaLayerVar.branchDefDisb,
    		htmlObject: "displayOneObj",
    		executeAtStart: false,
  		postExecution: function(){
   					var rows = $("#displayOneObj tbody tr");
   					rows.die("click");
   					rows.die("mouseover");
   					rows.die("mouseout");
   					rows.live("click", clickFunctionDisb);
   					rows.live("mouseover",mouseoverFunction);
   					rows.live("mouseout",mouseoutFunction);
   					$("#displayOneObj th:nth-child(1)").hide();
   					$("#displayOneObj td:nth-child(1)").hide();
  				}
  };


var remainingLoanOfficersDisbursement =
	{
 		name: "remainingLoanOfficersDisbursement",
		type: "tableComponent",
		listeners: ["selectedBranchIdDisb"],
		parameters: [["selectedBranchId","selectedBranchIdDisb"]],
		cdaParams: [["selectedBranchId","selectedBranchIdDisb"]],
    		chartDefinition: MetaLayerVar.loanOfficerDefDisb,
    		htmlObject: "displayTwoObj",
    		executeAtStart: false,
  		postExecution: function(){
   					var rows = $("#displayTwoObj tbody tr");
   					rows.die("click");
   					rows.die("mouseover");
   					rows.die("mouseout");
   					rows.live("click", clickFunctionLODisb);
   					rows.live("mouseover",mouseoverFunction);
   					rows.live("mouseout",mouseoutFunction);
   					$("#displayTwoObj th:nth-child(1)").hide();
   					$("#displayTwoObj td:nth-child(1)").hide();

  				}
  };


//

Dashboards.init([toptable, collection, disbursement, remainingBranchesCollection, remainingLoanOfficersCollection, remainingBranchesDisbursement, remainingLoanOfficersDisbursement]);

</script>
