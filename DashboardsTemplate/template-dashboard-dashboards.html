<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <title>Mifos Dashboards</title>
		<meta name="keywords" content="" />
		<meta name="description" content="" />
		<!--link href="/pentaho-style/dashboard.css" rel="stylesheet" type="text/css" media="screen" /-->
		<link rel="stylesheet" type="text/css" href="resources/style/template.css"/>
	</head>
	<body>

<style type="text/css">

#burndown {
	padding-left: 10px;
	padding-right: 10px;
	padding-top: 5px;

	display:none;
}

#breadcrumb {
	padding-bottom: 5px;
}

#breadcrumbBack {
	color: black;
	display: inline;
}

#breadcrumbBack a {
	color: #F79646; 
}

#breadcrumbCurrent {
	color: black;
	display: inline;
}

#toptableObj {
	padding-bottom: 10px;
}

#toptableObj th{
	padding-top: 5px;
	padding-bottom: 5px;
}

#toptableObj td{
	padding-top: 5px;
	padding-bottom: 5px;
	padding-right: 5px;
}

.boldLabel{
	color: black;
	padding-left: 5px;
	font-weight:bold;
	display: inline;
}

.sectionTable {
	border-collapse: collapse;
}

.borderSection {
      border-style: solid;
      border-width: 1px;
	padding: 0;
	vertical-align: text-top;
}

.viewAll {
	float: right;
}

.textlink {
	vertical-align: 30%;
}

.blueArrow {
	color: #5E99E3;
	font-size: 170%;
	display: inline;
	text-decoration: none;
}



#mainHeading {
      border-style: solid;
      border-width: 1px;
	padding-bottom: 10px;
}

</style>


<script language="javascript">

	isAdmin = "{isAdmin}";
	isLoggedIn = "{isLoggedIn}";


function pad2(number) {
    return (number < 10 ? '0' : '') + number
}

function setCurrentDate() {
    xxDate = new Date();
    return xxDate.getFullYear() + "-" + pad2(xxDate.getMonth() + 1) + "-" + pad2(xxDate.getDate());
}

function removeCommas(commaString)
{
    var re = /,/g;
    return commaString.replace(re,"");
}

function linkToPage(pageName, extraParams)
{
	linkTo = specificPage(pageName, extraParams);
	window.location = linkTo;
}

function specificPage(pageName, extraParams)
{
	return webAppPath + "/content/pentaho-cdf/RenderXCDF?solution=" + solution + "&path=" + path + "&action=" + pageName + ".xcdf&template=mantle" + extraParams;
}

//Start of Breadcrumb functionality - rigidly coded but works fine
function bcBackPages(currentName)
{
	var viewAllBranchesPage = currentName.substring(0,11);
	if (viewAllBranchesPage != collections)
	{
		viewAllBranchesPage = disbursals;
	}

	var bcBack = '<a href="' + specificPage(homePage, '') + '">' + homePageText + '</a>';
	if (viewAllBranchesPage != currentName)
	{
		bcBack = bcBack + " >> " + '<a href="' + specificPage(viewAllBranchesPage, '') + '">' + viewAllBranchesPage.toUpperCase() + '</a>';

		var viewAllLOsPage = viewAllBranchesPage + LO;
		if (currentName != viewAllLOsPage)
		{
			var branchParams = "&branchId=" + branchIdParam + "&branchName=" + branchNameParam;
			bcBack = bcBack + " >> " + '<a href="' + specificPage(viewAllLOsPage,  branchParams) + '">' + branchNameParam + '</a>'
		}
	}
	return bcBack;
}


function bcCurrentPage(currentName)
{
	var bcCurrent = currentName.toUpperCase();
	if (branchNameParam > '')
	{
		bcCurrent = branchNameParam;
	}
	if (LONameParam > '')
	{
		bcCurrent = LONameParam;
	}
	return " >> " + bcCurrent;
}

function constructBreadcrumb(currentName)
{
	if (currentName == homePage)
	{
   		$("#breadcrumb").css("display", "none");
	}
	else
	{
   		$("#breadcrumbBack").html(bcBackPages(currentName));
   		$("#breadcrumbCurrent").html(bcCurrentPage(currentName));
	}
}
//End of Breadcrumb functionality



function finalisePage()
{
	var fullstop = actionParam.indexOf(".");
	var currentName = actionParam.substring(0, fullstop);

	constructBreadcrumb(currentName);

	if (currentName == "CollectionsDisbursalsBurndown")
	{
   		$(".sectionTable > tbody > tr:nth-child(1)").css("background-color", lighterOrange);
   		$(".sectionTable > tbody > tr:nth-child(1) > td").css("border-bottom-style","solid");
   		$(".sectionTable > tbody > tr:nth-child(1) > td").css("border-width","1px");
   		$(".sectionTable > tbody > tr:nth-child(1) > td").css("border-color", darkOrange);
   		$(".sectionTable > tbody > tr:nth-child(1) > td").css("padding-top", "5px");
   		$(".sectionTable > tbody > tr:nth-child(1) > td").css("padding-bottom", "5px");

   		$(".borderSection").css("border-color", darkOrange);
	}
	else
	{
   		$("#mainHeading").css("background-color", lighterOrange);
   		$("#mainHeading").css("border-color", darkOrange);
   		$("#mainHeading").css("padding-top", "5px");
   		$("#mainHeading").css("padding-bottom", "5px");
	}
	$("#burndown").slideToggle("slow");
}

var lighterOrange = "#FCD5B5";
var darkOrange = "#F79646";
var darkBlue = "#4F81BD";
var white = "white";
var black = "black";
var oddRow = "#D0D8E8";
var evenRow = "#E9EDF4";
var topTableRows = "#FDEFE9";

//var currentDate = '2010-09-01';
var currentDate = setCurrentDate();

var homePage = "CollectionsDisbursalsBurndown";
var homePageText = "HOME";
var collections = "Collections";
var disbursals = "Disbursals";
var LO = "LO";


var solution = Dashboards.getQueryParameter("solution");
var path = Dashboards.getQueryParameter("path");
var cdaPath = solution + path + "CollectionsDisbursalsBurndown.cda";
var branchIdParam = Dashboards.getQueryParameter("branchId");
var branchNameParam = Dashboards.getQueryParameter("branchName");
var LOIdParam = Dashboards.getQueryParameter("LOId");
var LONameParam = Dashboards.getQueryParameter("LOName");
var actionParam = Dashboards.getQueryParameter("action");

var collectionCompleted = 0;
var collectionRemaining = 0;
var disbursementCompleted = 0;
var disbursementRemaining = 0;

Dashboards.globalcontext = false;

</script>

	<!-- start header -->
	<div id="burndown">
		<div id=breadcrumb>
			<div id=breadcrumbBack></div>
			<div id=breadcrumbCurrent></div>
		</div>
		{content}
	</div>
	<div class="clear"/>
</body>
</html>
