insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Benin 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Littoral' then 0 when answers.Q1='Mono' then 1 when answers.Q1='Zou, Atlantique, or Collines' then 3 when answers.Q1='Couffo' then 4 when answers.Q1='Plateau' then 7 when answers.Q1='Ou?m?' then 11 when answers.Q1='Donga, or Borgou' then 12 when answers.Q1='Alibori' then 13 when answers.Q1='Atakora' then 14 end + case when answers.Q2='Earth, stone, wood/planks, palm leaves/bamboo, or other' then 0 when answers.Q2='Mud plastered with cement' then 1 when answers.Q2='Bricks' then 4 end + case when answers.Q3='Eight or more' then 0 when answers.Q3='Seven' then 6 when answers.Q3='Six' then 10 when answers.Q3='Five' then 14 when answers.Q3='Four' then 20 when answers.Q3='Three' then 30 when answers.Q3='Two' then 40 when answers.Q3='One' then 48 end + case when answers.Q4='No' then 0 when answers.Q4='Yes' then 3 when answers.Q4='There is no female head/spouse' then 3 end + case when answers.Q5='Kerosene' then 0 when answers.Q5='Electricity, LPG, oil, solar energy, electric generator (community or private), or other' then 4 end + case when answers.Q6='One' then 0 when answers.Q6='Two' then 2 when answers.Q6='Three or more' then 5 end + case when answers.Q7='Firewood, or straw' then 0 when answers.Q7='Charcoal, electricity, LPG, kerosene, or other' then 3 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 5 end + case when answers.Q9='None' then 0 when answers.Q9='One' then 2 when answers.Q9='Two or more' then 9 end + case when answers.Q10='Does not own etc.' then 0 when answers.Q10='Does own etc., but land is not sub-divided, developed, or irrigated' then 2 when answers.Q10='Does own etc., and some land is sub-divided, developed, or irrigated' then 5 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_department', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_main_exterior_wall_material', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_family_members', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_female_head_can_read_french', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_lighting_fuel', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_sleeping_rooms', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_cooking_fuel', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_owns_car_motorcycle', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_phones', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_land_owned', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Benin 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
