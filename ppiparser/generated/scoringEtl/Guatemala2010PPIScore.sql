insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Guatemala 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Cinco o m?s' then 0 when answers.Q1='Cuatro' then 10 when answers.Q1='Tres' then 12 when answers.Q1='Dos' then 17 when answers.Q1='Uno' then 23 when answers.Q1='Ninguno' then 33 end + case when answers.Q2='No' then 0 when answers.Q2='No hay ni?os de edades 7 a 13' then 2 when answers.Q2='S?' then 6 end + case when answers.Q3='No' then 0 when answers.Q3='S?' then 6 when answers.Q3='No hay jefa/esposa del hogar' then 9 end + case when answers.Q4='S?' then 0 when answers.Q4='No' then 5 end + case when answers.Q5='Tierra, madera, parqu? u otro' then 0 when answers.Q5='Ladrillo de barro o torta de cemento' then 3 when answers.Q5='Ladrillo de cemento' then 9 when answers.Q5='Ladrillo cer?mico' then 15 end + case when answers.Q6='No' then 0 when answers.Q6='S?' then 9 end + case when answers.Q7='No' then 0 when answers.Q7='S?' then 8 end + case when answers.Q8='S?' then 0 when answers.Q8='No' then 3 end + case when answers.Q9='No' then 0 when answers.Q9='S?' then 8 end + case when answers.Q10='No' then 0 when answers.Q10='S?' then 3 when answers.Q10='Nadie se dedica a la agricultura' then 4 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_family_members_0_to_13', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_all_family_members_7_to_13_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_female_head_literate', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_empoyed_as_casual_labor', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_house_floors', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_has_refrigerator', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_has_gas_electric_stove', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_has_stone_mill', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_has_electric_iron', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_enmployed_in_agriculature_or_animals', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Guatemala 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
