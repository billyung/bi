insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI India 2008', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Five or more / ಐದು ಅಥವಾ ಅಧಿಕ / पान्च या उससे अधिक' then 0 when answers.Q1='Four / ನಾಲ್ಕು / चार' then 4 when answers.Q1='Three / ಮೂರು / तीन' then 8 when answers.Q1='Two / ಎರಡು / दो' then 13 when answers.Q1='One / ಒ೦ದು / एक' then 20 when answers.Q1='None / ಯಾವುದು ಇಲ್ಲ / कॊई नहीं' then 27 end + case when answers.Q2='Labourers (agricultural, plantation, other farm), hunters, tobacco preparers and tobacco product makers, and other labourers / ಕೂಲಿಕಾರರು (ಕೃಷಿ/ಕೃಷಿಗೆ ಸ೦ಬ೦ದಿಸಿದ/ಇತರೆ) ಕೂಲಿಕಾರರು ಬೀಡಿ ತಯಾರಕರು / ಹೊಗೆ ಸೊಪ್ಪು ಉತ್ಪನ್ನ ತಯಾರಕರು / मजदूर, शिकारि, बीडी व तंबाकू उत्पादन अन्य मजदूर' then 0 when answers.Q2='Others / ಇತರೆ / अन्य' then 8 when answers.Q2='Professionals, technicians, clerks, administrators, managers, executives, directors, supervisors, and teachers / ತಾ೦ತ್ರಿಕಗಾರರು/ವೃತ್ತಿ ನಿರತರು/ಆಡಳಿತ ವರ್ಗ/ವ್ಯವಸ್ಥಾಪಕ ವರ್ಗ/ನಿರ್ವಾಹಕರು/ನಿರ್ಧೇಶಕರು/ಶಿಕ್ಷಕರು / पेशॆवार, तकनीशियन, क्लर्क, प्रशासक, प्रबन्धक, अधिशासी निर्दॆशक, पर्यवॆक्षक ऎव० शिक्षक' then 14 end + case when answers.Q3='No / ಇಲ್ಲ / नहीं' then 0 when answers.Q3='Yes / ಹೌದು / हाँ' then 4 end + case when answers.Q4='Firewood and chips, charcoal, or none / ಕಟ್ಟಿಗೆ/ಇದ್ದಿಲು/ಯಾವುದೂ ಅಲ್ಲ / जलावन, लकडी और टूकडे, कॊयला अथवा कुछ नहीं' then 0 when answers.Q4='Others / ಸೀಮೆ ಎಣ್ಣೆ/ಗೋಬರ್ ಗ್ಯಾಸ್/ವಿದ್ಯುತ್ ಸ್ಟೌವ್/ಇತರೆ / अन्य' then 5 when answers.Q4='LPG / ಗ್ಯಾಸ್ (ಎಲ್.ಪಿ.ಜಿ) / गैस चूंल्हा' then 17 end + case when answers.Q5='No / ಇಲ್ಲ / नहीं' then 0 when answers.Q5='Yes / ಇದೆ / हाँ' then 6 end + case when answers.Q6='No / ಇಲ್ಲ / नहीं' then 0 when answers.Q6='Yes / ಇದೆ / हाँ' then 5 end + case when answers.Q7='No / ಇಲ್ಲ / नहीं' then 0 when answers.Q7='Yes / ಇದೆ / हाँ' then 3 end + case when answers.Q8='No / ಇಲ್ಲ / नहीं' then 0 when answers.Q8='Yes / ಇದೆ / हाँ' then 6 end + case when answers.Q9='None / ಒ೦ದೂ ಇಲ್ಲ / कुछ नहीं' then 0 when answers.Q9='One / ಒ೦ದು / एक' then 6 when answers.Q9='Two or more / ಎರಡು ಅಥವಾ ಅಧಿಕ / दो या उससे अधिक' then 9 end + case when answers.Q10='None / ಒ೦ದೂ ಇಲ್ಲ / कुछ नहीं' then 0 when answers.Q10='One / ಒ೦ದು / एक' then 5 when answers.Q10='Two or more / ಎರಡು ಅಥವಾ ಅಧಿಕ / दो या उससे अधिक' then 9 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_family_members_0_to_17', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_principal_occupation', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_has_pucca_home', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_cooking_fuel', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_owns_television', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_owns_bicycle_scooter_motorcycle', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_owns_almirah', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_owns_sewing_machine', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_pressure_cookers', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_electric_fans', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI India 2008' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
