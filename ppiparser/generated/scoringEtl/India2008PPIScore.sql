insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI India 2008', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Four or more' then 0 when answers.Q1='Three' then 7 when answers.Q1='Two' then 11 when answers.Q1='One' then 17 when answers.Q1='Zero' then 26 end + case when answers.Q2='No male head/spouse' then 0 when answers.Q2='Not literate, no formal school, or primary or below' then 0 when answers.Q2='Middle' then 3 when answers.Q2='Secondary or higher secondary' then 5 when answers.Q2='Diploma/certificate course, graduate, or postgraduate and above' then 7 end + case when answers.Q3='Labour (agricultural, casual, or other)' then 0 when answers.Q3='Self-employed (agriculture or non-agriculture), regular wage/salary-earning, or others' then 5 end + case when answers.Q4='Firewood and chips, dung cake, kerosene, charcoal, coke or coal, gobar gas, or others' then 0 when answers.Q4='LPG or electricity' then 3 when answers.Q4='No cooking arrangement' then 9 end + case when answers.Q5='No' then 0 when answers.Q5='Yes' then 5 end + case when answers.Q6='No, neither one' then 0 when answers.Q6='Yes, only one' then 4 when answers.Q6='Yes, both' then 9 end + case when answers.Q7='No, neither one' then 0 when answers.Q7='Yes, only a mobile' then 9 when answers.Q7='Yes, a landline, regardless of mobile' then 15 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 1 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 5 end + case when answers.Q10='No, none' then 0 when answers.Q10='Yes, bicycle only, no motorcycle/scooter, or car' then 1 when answers.Q10='Motorcycle/scooter, but no car (regardless of bicycle)' then 13 when answers.Q10='Motor car/jeep (regardless of others)' then 18 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_family_members_0_to_17', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_male_head_education_level', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_household_type', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_cooking_fuel', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_owns_casseroles_thermos_thermoware', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_owns_vcr_vcd_dvd', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_phones', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_owns_sewing_machine', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_onws_almirah', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_owns_bicycle_scooter_car', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI India 2008' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
