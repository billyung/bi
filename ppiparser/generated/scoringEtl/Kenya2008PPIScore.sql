insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Kenya 2008', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Nine or more' then 0 when answers.Q1='Seven or eight' then 5 when answers.Q1='Six' then 8 when answers.Q1='Five' then 12 when answers.Q1='Four' then 18 when answers.Q1='Three' then 22 when answers.Q1='One or two' then 32 end + case when answers.Q2='None, or pre-school' then 0 when answers.Q2='Primary standards 1 to 6' then 1 when answers.Q2='Primary standard 7' then 2 when answers.Q2='Primary standard 8, or secondary' then 6 when answers.Q2='No female head/spouse' then 6 when answers.Q2='Secondary form 4 or higher' then 11 end + case when answers.Q3='Does not work' then 0 when answers.Q3='No male head/spouse' then 3 when answers.Q3='Agriculture, hunting, forestry, fishing, mining, or quarrying' then 7 when answers.Q3='Any other' then 9 end + case when answers.Q4='One' then 0 when answers.Q4='Two' then 2 when answers.Q4='Three' then 5 when answers.Q4='Four or more' then 8 end + case when answers.Q5='Wood, earth, or other' then 0 when answers.Q5='Cement, or tiles' then 3 end + case when answers.Q6='Collected firewood, purchased firewood, grass, or dry cell (torch)' then 0 when answers.Q6='Paraffin, candles, biogas, or other' then 6 when answers.Q6='Electricity, solar, or gas' then 12 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 4 end + case when answers.Q8='None' then 0 when answers.Q8='One' then 2 when answers.Q8='Two or more' then 4 end + case when answers.Q9='None' then 0 when answers.Q9='One' then 6 when answers.Q9='Two or more' then 10 end + case when answers.Q10='None' then 0 when answers.Q10='One' then 3 when answers.Q10='Two or more' then 7 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_female_head_education_level', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_male_head_occupation', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_house_rooms', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_house_floors', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_lighting_fuel', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_owns_iron', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_mosquito_nets', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_towels', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_frying_pans', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Kenya 2008' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
