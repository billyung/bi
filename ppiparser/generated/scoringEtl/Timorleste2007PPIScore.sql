insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Timorleste 2007', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Ainaro, Manufahi, or Manatuto' then 0 when answers.Q1='Aileu, Dili, or Ermera' then 6 when answers.Q1='Bobonaro, Cova Lima, Liquiçá, or Oecussi' then 11 when answers.Q1='Baucau, Lautém, and Viqueque' then 23 end + case when answers.Q2='Six or more' then 0 when answers.Q2='Four or five' then 8 when answers.Q2='Three' then 13 when answers.Q2='Two' then 19 when answers.Q2='One' then 29 when answers.Q2='None' then 34 end + case when answers.Q3='No, or no members 8 to 17' then 0 when answers.Q3='Yes' then 3 end + case when answers.Q4='No' then 0 when answers.Q4='Yes' then 3 end + case when answers.Q5='None, pre-school, or primary class 1' then 0 when answers.Q5='Primary class 2 to 5' then 2 when answers.Q5='No male head/spouse' then 3 when answers.Q5='Primary class 6, to pre-secondary class 2' then 5 when answers.Q5='Pre-secondary class 3, or higher' then 7 end + case when answers.Q6='Mud, wood, bamboo, rattan, tin, or other' then 0 when answers.Q6='Brick, concrete, or unbaked brick' then 8 end + case when answers.Q7='Earth/clay, wood, bamboo, or other' then 0 when answers.Q7='Concrete/brick, floor tile/cement, marble/ceramic' then 3 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 4 end + case when answers.Q9='None' then 0 when answers.Q9='One' then 2 when answers.Q9='Two or more' then 4 end + case when answers.Q10='1 to 1,499' then 0 when answers.Q10='1,500 to 2,999' then 3 when answers.Q10='3,000 to 9,999' then 6 when answers.Q10='None' then 6 when answers.Q10='10,000 or more' then 11 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_district', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_family_members_0_to_17', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_family_members_6_to_17_in_school', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_family_members_had_job_last_year', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_male_head_education', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_house_walls', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_house_floors', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_owns_television', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_clothes_cupboards_owned', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_land_owned', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Timorleste 2007' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
