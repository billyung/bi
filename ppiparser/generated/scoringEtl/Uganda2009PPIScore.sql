insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Uganda 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Six or more' then 0 when answers.Q1='Four or five' then 6 when answers.Q1='Three' then 9 when answers.Q1='Two' then 14 when answers.Q1='One' then 27 end + case when answers.Q2='Not all attend' then 0 when answers.Q2='All attend government schools' then 2 when answers.Q2='No children ages 6 to 18' then 4 when answers.Q2='All attend, and one or more attend a private, NGO/religious, or boarding school' then 5 end + case when answers.Q3='No female head/spouse' then 0 when answers.Q3='P.5 or less, or none' then 2 when answers.Q3='P.6' then 6 when answers.Q3='P.7 to S.6' then 8 when answers.Q3='Higher than S.6' then 19 end + case when answers.Q4='Thatch, straw, or other' then 0 when answers.Q4='Iron sheets, or tiles' then 5 end + case when answers.Q5='Un-burnt bricks, mud and poles, thatch/straw. timber, stone, burnt bricks with mud, other' then 0 when answers.Q5='Burnt bricks with cement, or cement blocks' then 2 end + case when answers.Q6='Firewood' then 0 when answers.Q6='Tadooba, or other' then 11 when answers.Q6='Paraffin lantern, or electricity (grid, generator, solar)' then 17 end + case when answers.Q7='Bush (none)' then 0 when answers.Q7='Covered pit latrine (private or shared), VIP latrine (private or shared), uncovered pit latrine, flush toilet (private or shared), or other' then 4 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 7 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 5 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 9 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_family_members_6_to_18_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_female_head_education_level', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_house_roof', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_house_walls', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_lighting_fuel', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_toilet_type', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_owns_electronic_equipment', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_at_least_two_sets_of_clothes', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_at_least_a_pair_of_shoes', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Uganda 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
