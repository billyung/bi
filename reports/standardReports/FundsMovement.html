<table width=100%>
<tr>
<td><a href="#"><img src="resources/style/images/mifoslogo.jpg" border="0"/></a></td>
<td><div class=reportLabel>Office</div><div id=branchSelectorObj></div></td>
<td><div class=reportLabel>Source of Funds</div><div id=funderSelectorObj></div></td>
<td><div class=reportLabel>As On Date</div><div id=dateObj></div></td>
<td><div class=reportLabel>Output Type</div><div id=outputSelectorObj></div></td>
</tr>
<tr>
<td><div id=runReportObj></div></td>
<td><div id=clearReportObj style="visibility:hidden"></div></td>
</tr>
</table>

<div id=theReportObj></div>

<script language="javascript" type="text/javascript">

function runTheReport()
{
    event = event + 1;
    Dashboards.fireChange("event", event);
    document.getElementById('clearReportObj').style.visibility = "visible";
}


var solution = Dashboards.getQueryParameter("solution");
var path = Dashboards.getQueryParameter("path");

function endsWith(str, suffix) {
    return str.indexOf(suffix, str.length - suffix.length) !== -1;
}

var prptPath = endsWith(path, "/") ? path + "prpts" : path + "/prpts";

var commonActionsSolution = "commonActions";

Dashboards.globalcontext = false;
var event = 0;
var officeId = 0;
var funderId = 0;


var currentDate = new Date();
var month = currentDate.getMonth() + 1;
var currentDateStr = currentDate.getFullYear() + "-" + month + "-" + currentDate.getDate();

var outDate = currentDateStr;
var outputType = "application/pdf";

 
branchSelector = 
{
	name: "branchSelector",
	type: "select",
	parameters:[],
  	solution: commonActionsSolution,
  	path: "/" ,
  	action: "OfficeListSearchId.xaction",
	parameter: "officeId",
	valueAsId: false,
	htmlObject: "branchSelectorObj",
	executeAtStart: true
};

funderSelector = 
{
	name: "funderSelector",
	type: "select",
	parameters:[],
  	solution: commonActionsSolution,
  	path: "/" ,
  	action: "FunderList.xaction",
	parameter: "funderId",
	valueAsId: false,
	htmlObject: "funderSelectorObj",
	executeAtStart: true
};


asOnDate = 
{
	name: "asOnDate",
	type: "dateInputComponent",
	parameters:[],
	parameter: "outDate",
	htmlObject: "dateObj",
	executeAtStart: true
};

outputSelector = 
{
	name: "outputSelector",
	type: "select",
	parameters:[],
	valuesArray:[["application/pdf","PDF"], ["text/html","HTML"], ["application/vnd.ms-excel","EXCEL"]],
	parameter:"outputType",
	valueAsId: false,
	htmlObject: "outputSelectorObj",
	executeAtStart: true
}

runReport = 
{
  	name: "runReport",
  	type: "Button",
  	htmlObject: "runReportObj",
  	label: "Run Report",
  	expression: function(){runTheReport();},
  	executeAtStart: true
}

clearReport = 
{
  	name: "clearReport",
  	type: "Button",
  	htmlObject: "clearReportObj",
  	label: "Clear Report",
  	expression: function(){$('#theReportObj').html("");document.getElementById('clearReportObj').style.visibility = "hidden";},
  	executeAtStart: true
}

theReport = 
{
  	name: "theReport",
  	type: "prpt",
  	solution: solution,
  	path: prptPath,
  	action: "FundsMovement.prpt",
  	listeners:["event"],
  	parameters: [["selected_office","officeId"],["selected_funder","funderId"],["out_date","outDate"],["output-type","outputType"]],
  	htmlObject: "theReportObj",
  	executeAtStart: false,
  	paginate: false,
	showParameters: false
}

Dashboards.init([branchSelector, funderSelector, asOnDate, outputSelector, runReport, clearReport, theReport]);

$(document).ready(function() {
	$('#branchSelectorObj select option:eq(0)').attr('selected', 'selected')
	officeId = $('#branchSelectorObj select option:selected').val();
	$('#funderSelectorObj select option:eq(0)').attr('selected', 'selected')
	funderId = $('#funderSelectorObj select option:selected').val();
});

</script>
